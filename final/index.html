<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Revenge of Lights Out</title>

  <!-- Font craziness -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Comic+Neue:wght@300;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --tile-size: 64px;
      --gap: 8px;
      --bg: #111;
      --tile-on: #fffff0;
      --tile-off: #111;
      --accent: #ffb86b;
    }
    html,body{
      height:100%;
      margin:0;
      font-family: "Comic Neue", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(120deg,#0f172a 0%, #071029 50%, #00121a 100%);
      color: #eee;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 32px;
      box-sizing:border-box;
    }

    .container{
      width:max-content;
      text-align:center;
    }

    h1{
      margin:0 0 12px;
      font-family:"Press Start 2P", monospace;
      letter-spacing:1px;
      font-size:18px;
      color:var(--accent);
      text-shadow:0 2px 6px rgba(0,0,0,0.6);
    }

    .subtitle{
      margin:8px 0 18px;
      opacity:0.9;
      font-size:13px;
    }

    .board{
      display:grid;
      grid-template-columns:repeat(5, var(--tile-size));
      gap:var(--gap);
      background:rgba(255,255,255,0.02);
      padding:18px;
      border-radius:12px;
      box-shadow:0 8px 30px rgba(0,0,0,0.6);
      margin-bottom:14px;
    }

    .cell{
      width:var(--tile-size);
      height:var(--tile-size);
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
      transition:transform 120ms ease, box-shadow 120ms ease;
      box-shadow:0 4px 10px rgba(0,0,0,0.6), inset 0 -6px 12px rgba(0,0,0,0.3);
      font-family:"Press Start 2P", monospace;
      font-size:10px;
    }

    .cell.is-on{
      background:var(--tile-on);
      color:#111;
      transform:translateY(-4px);
      box-shadow:0 10px 30px rgba(255,255,255,0.08), 0 1px 0 rgba(0,0,0,0.2);
    }

    .cell.is-off{
      background:var(--tile-off);
      color:#fff;
    }

    .controls{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-bottom:14px;
    }

    button{
      background:transparent;
      border:2px solid rgba(255,255,255,0.08);
      color:#fff;
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      letter-spacing:0.6px;
    }

    button.primary{
      border-color:var(--accent);
      background:linear-gradient(90deg,rgba(255,184,107,0.12),rgba(255,184,107,0.04));
      color:var(--accent);
    }

    .footer-note{
      margin-top:8px;
      font-size:12px;
      opacity:0.8;
    }

    @media (max-width:520px){
      :root{ --tile-size:46px; --gap:6px }
      h1{ font-size:14px }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Revenge of Lights Out</h1>
    <div class="subtitle">Click tiles to toggle them and their neighbors. Turn all tiles ON to win.</div>

    <div class="controls">
      <button id="newBtn" class="primary">New puzzle</button>
      <button id="resetBtn">Reset</button>
      <button id="solveBtn">Show solution</button>
    </div>

    <div id="board" class="board"></div>

    <div class="footer-note">Each new puzzle is guaranteed solvable.</div>
  </div>

  <!-- FOOTER WITH ADDENDUM (REQUIRED SCRIPT INCLUDED) -->
  <footer style="margin-top:30px; text-align:center; max-width:700px; color:#ddd;">
      <p>Last updated:
          <span id="lastModified"></span>
      </p>

      <section id="addendum" style="margin-top:14px; font-size:14px; line-height:1.5; background:rgba(255,255,255,0.03); padding:14px; border-radius:10px;">
          <h3 style="margin:0 0 8px; font-size:18px; color:#ffb86b;">Addendum</h3>

          <p><strong>Process & Approach:</strong> This Lights Out game was built using HTML, CSS Grid, and JavaScript. Each tile is interactive using event listeners and toggles itself plus its neighbors.</p>

          <p><strong>Solvable Randomization:</strong> To ensure every puzzle is solvable, I began with a solved (all-ON) board and applied random valid toggles. Since toggles are self-inverse, reversing the same moves produces the solution.</p>

          <p><strong>Creative Choices:</strong> I incorporated two Google Fonts (“Press Start 2P” and “Comic Neue”) to meet the font-craziness requirement. The board uses a dark sci-fi theme, animated tiles, and a glowing design for better visual feedback.</p>

          <p><strong>Challenges:</strong> The main challenge was generating solvable puzzles. Simulating random moves from the solved state was the simplest correct method. Tracking these moves also made it possible to animate the solution visualization.</p>

          <p><strong>Insights:</strong> Treating tile toggling as a reversible operation simplifies puzzle logic. Random toggling directly from the solved board is a reliable and elegant method to guarantee solvability.</p>
      </section>
  </footer>

  <script type="text/javascript">
       var x = document.lastModified;
       document.getElementById('lastModified').textContent = x;
  </script>

  <script>
  (function () {
    const ROWS = 5, COLS = 5;
    const boardEl = document.getElementById('board');
    const newBtn = document.getElementById('newBtn');
    const resetBtn = document.getElementById('resetBtn');
    const solveBtn = document.getElementById('solveBtn');

    let state = Array(ROWS*COLS).fill(true);
    let startState = null;
    let lastMoves = null;

    function idx(r,c){ return r*COLS + c; }
    function inBounds(r,c){ return r>=0 && c>=0 && r<ROWS && c<COLS; }

    function createBoard(){
      boardEl.innerHTML = '';
      for(let r=0;r<ROWS;r++){
        for(let c=0;c<COLS;c++){
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.dataset.r = r;
          cell.dataset.c = c;
          cell.addEventListener('click', () => {
            toggleAt(r,c);
            render();
            checkWin();
          });
          boardEl.appendChild(cell);
        }
      }
    }

    function toggleAt(r,c){
      const positions = [[r,c],[r-1,c],[r+1,c],[r,c-1],[r,c+1]];
      positions.forEach(([rr,cc])=>{
        if(inBounds(rr,cc)){
          const i = idx(rr,cc);
          state[i] = !state[i];
        }
      });
    }

    function render(){
      const cells = boardEl.children;
      for(let r=0;r<ROWS;r++){
        for(let c=0;c<COLS;c++){
          const i = idx(r,c);
          const el = cells[i];
          if(state[i]){
            el.classList.add('is-on');
            el.classList.remove('is-off');
          } else {
            el.classList.add('is-off');
            el.classList.remove('is-on');
          }
        }
      }
    }

    function checkWin(){
      if(state.every(v => v === true)){
        window.alert("You win!");
      }
    }

    function resetToStart(){
      if(startState) state = startState.slice();
      render();
    }

    function generateSolvable(randomMoves = 30){
      state = Array(ROWS*COLS).fill(true);
      const moves = [];
      for(let k=0;k<randomMoves;k++){
        const r = Math.floor(Math.random()*ROWS);
        const c = Math.floor(Math.random()*COLS);
        toggleAt(r,c);
        moves.push([r,c]);
      }
      startState = state.slice();
      return moves;
    }

    function showSolution(moves){
      let i = moves.length - 1;
      const interval = setInterval(()=>{
        const [r,c] = moves[i];
        toggleAt(r,c);
        render();
        i--;
        if(i < 0){
          clearInterval(interval);
          checkWin();
        }
      }, 140);
    }

    newBtn.addEventListener('click', () => {
      lastMoves = generateSolvable(30 + Math.floor(Math.random()*20));
      render();
    });

    resetBtn.addEventListener('click', resetToStart);

    solveBtn.addEventListener('click', () => {
      if(!lastMoves) return alert("Generate a puzzle first!");
      showSolution(lastMoves);
    });

    createBoard();
    lastMoves = generateSolvable(40);
    render();

  })();
  </script>
</body>
</html>
